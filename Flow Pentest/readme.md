# Hướng dẫn kỹ thuật tối thiểu trong pentest ứng dụng Web

# 1\. Mục đích tài liệu
*   Đảm bảo chất lượng đồng đều cho các pentester.
*   Chuẩn hóa quy trình kỹ thuật trong từng dự án.
*   Tránh bỏ sót kiểm tra các bề mặt tấn công cơ bản.
# 2\. Danh sách công việc bắt buộc tối thiểu
## 2.2 Recon
### 2.2.1 **Technology Fingerprinting**
#### Wappalyzer
*   Cài đặt:
    *   CLI: [https://github.com/projectdiscovery/wappalyzergo/](https://github.com/projectdiscovery/wappalyzergo/)
    *   Extension/Addon:
        *   [https://chromewebstore.google.com/detail/wappalyzer-technology-pro/gppongmhjkpfnbhagpmjfkannfbllamg?hl=en](https://chromewebstore.google.com/detail/wappalyzer-technology-pro/gppongmhjkpfnbhagpmjfkannfbllamg?hl=en)
        *   [https://addons.mozilla.org/en-US/firefox/addon/wappalyzer/](https://addons.mozilla.org/en-US/firefox/addon/wappalyzer/)
*   Sử dụng:

```plain
wappalyzer -i domain.com
```

### 2.2.2 Dorking
#### Fast-Google-Dorks-Scan
*   Cài đặt: [https://github.com/IvanGlinkin/Fast-Google-Dorks-Scan](https://github.com/IvanGlinkin/Fast-Google-Dorks-Scan)
*   Sử dụng:

```plain
./FGDS.sh domain.com
```

#### GitDorker
*   Cài đặt: [https://github.com/obheda12/GitDorker](https://github.com/obheda12/GitDorker)
*   Sử dụng:

```bash
python3 GitDorker.py -tf TOKENSFILE -q domain.com -d Dorks/DORKFILE -o domain
```

### **2.2.3 Template Based Scanning**
#### Nuclei
*   Cài đặt: [https://github.com/projectdiscovery/nuclei](https://github.com/projectdiscovery/nuclei)
*   Sử dụng: nuclei -u [https://domain.com](https://domain.com)
  
### 2.2.4 **Directory Enumeration**
#### Dirsearch
*   Cài đặt: [https://github.com/maurosoria/dirsearch](https://github.com/maurosoria/dirsearch)
*   Sử dụng:

```plain
python3 /usr/lib/python3/dist-packages/dirsearch/dirsearch.py -u https://domain.com/ -e "*" -x 404,400 -r 3 -t 7
```

### 2.2.5 Wayback History
#### [Phonebook.io](http://Phonebook.io)
Sử dụng trên giao diện của [phonebook.io](http://phonebook.io), search theo URLs
#### Gau
*   Cài đặt:
    *   Gau: [https://github.com/lc/gau](https://github.com/lc/gau)
    *   uro: [https://github.com/s0md3v/uro](https://github.com/s0md3v/uro)
    *   httpx: [https://github.com/projectdiscovery/httpx](https://github.com/projectdiscovery/httpx)
*   Sử dụng:

```plain
gau domain.com | uro | httpx -proxy http://127.0.0.1:8080
gau thamquannhamay.ajinomoto.com.vn | uro | httpx -silent -threads 40 -timeout 10 -proxy http://127.0.0.1:8080 -json -o alive.json
```

### 2.2.6 Crawler
#### Katana
*   Cài đặt: [https://github.com/projectdiscovery/katana](https://github.com/projectdiscovery/katana)
*   Sử dụng:

```plain
katana -u https://domain.com -d 10 -proxy http://127.0.0.1:8080
gau domain.com | uro | httpx -silent -threads 40 -timeout 10 -proxy http://127.0.0.1:8080 -json -o alive.json
```

### 2.2.7 JS Recon
#### JS Link Finder (Burp Extension)
*   Cài đặt: BAap Store → JS Link Finder
*   Sử dụng:
    *   Crawl toàn bộ ứng dụng (kết hợp kết quả từ Gau)
    *   Ở Tab Target, chọn một hoặc nhiều target → click chuột phải chọn **Passively scan selected branches** → Kết quả Extract URLs sẽ hiển thị ở tab **BurpJSLinkFinder**
#### JS Miner (Burp Extension)
*   Cài đặt: BAap Store → JS Miner
*   Sử dụng:
    *   Crawl toàn bộ ứng dụng (kết hợp kết quả từ Gau)
    *   Ở Tab Target, chọn một hoặc nhiều target → click chuột phải chọn **Passively scan selected branches**
    *   Ở Tab Target, chọn một hoặc nhiều target →click chuột phải → Extensions → JS Miner → Run JS Auto-Mine (check everything) → Kết quả scan sẽ hiện ở tab Target → Issues
#### JS Analysis with Nuclei template
*   Cài đặt: Nuclei & template [https://github.com/projectdiscovery/nuclei](https://github.com/projectdiscovery/nuclei)
*   Sử dụng:
    *   Copy toàn bộ file JS từ Burp Suite ra file **js.txt** bằng Extension **Burpsuite-js-extractor** [https://github.com/PatrikFehrenbach/burpsuite-js-extractor](https://github.com/PatrikFehrenbach/burpsuite-js-extractor)
    *   Command:

```plain
nuclei -l js.txt -t ~/nuclei-templates/exposures/ -o results.txt
```

#### SecretFinder
### SecretFinder
*   Cài đặt:﻿ [https://github.com/m4ll0k/SecretFinder](https://github.com/m4ll0k/SecretFinder)
*   Sử dụng:
    *   Copy toàn bộ file JS từ Burp Suite ra file **js.txt** bằng Extension Burp [https://github.com/PatrikFehrenbach/burpsuite-js-extractor](https://github.com/PatrikFehrenbach/burpsuite-js-extractor)
    *   Ở Folder SecretFinder chạy bash sau: input là js.txt, secretfinder.txt kết quả scan

```plain
while IFS= read -r url; do
  printf "\\n[URL] %s\\n" "$url" >> secretfinder.txt
  python3 SecretFinder.py -i "$url" -o cli >> secretfinder.txt 2>&1
done < js.txt
```

#### Retire.js (Burp Extension)
*   Cài đặt: BAap Store → Retire.js
*   Sử dụng: Tự chạy passive song song với Burp
### 2.2.7 Parameter Discovery
#### Param Miner
*   Cài đặt: BAap Store → Param Miner
*   Sử dụng: Ở Tab Target, chọn một hoặc nhiều target →click chuột phải → Extensions → Param Miner → Guest everything
### 2.2.8 Port Scanner
#### Nmap
*   Cài đặt: [https://github.com/nmap/nmap](https://github.com/nmap/nmap)
*   Sử dụng:

```plain
nmap -A -T4 -sV -Pn -p - domain.com
```

## 2.3 Burp Extensions
### 2.3.1 Danh sách bắt buộc tối thiểu
#### **Active Scan++**
*       *   Mở rộng khả năng quét chủ động với các kiểm tra nâng cao như host header attack, blind injection, exploit CVE.
    *   Dùng khi chạy active scan để phát hiện lỗi chuyên sâu.
#### **Backslash Powered Scanner**
*       *   Bổ sung phát hiện injection dựa trên lỗi xử lý backslash, giúp tìm lỗi lọt qua bộ lọc bình thường.
    *   Kích hoạt khi scan chủ động.
#### **JS Link Finder**
*       *   Quét và liệt kê các endpoint/URL ẩn trong file JavaScript.
    *   Dùng để khám phá điểm tấn công phía client.
#### **JS Miner**
*       *   Tự động phát hiện các lỗi bảo mật phổ biến trong mã JavaScript client-side.
#### **Retire.js**
*       *   Quét thư viện JavaScript lỗi thời, có lỗ hổng bảo mật đã biết.
    *   Giúp nhận biết thành phần rủi ro trong ứng dụng.
#### **Autorize**
*       *   Test nhanh các testcase liên quan xác thực (Authentication) và kiểm soát truy cập (BAC).
    *   Thủ công, cấu hình token/cookie người dùng quyền thấp để phát hiện lỗi ủy quyền.
#### **Collaborator Everywhere**
*       *   Passive phát hiện lỗi tương tác ngoài server (SSRF, blind XSS, RCE) qua payload Burp Collaborator.
#### **403 Bypasser**
*       *   Tự động bypass các trang lỗi 403 Forbidden bằng nhiều kỹ thuật khác nhau.
#### **JWT Scanner**
*       *   Phát hiện và kiểm tra bảo mật các JSON Web Tokens trong request, cảnh báo lỗi ký token, thuật toán, cấu hình.
#### **Software Vulnerability Scanner**
*       *   Tự động quét phát hiện lỗ hổng trong phần mềm, framework được dùng trên website.
#### **Software Version Reporter**
*       *   Thu thập phiên bản phần mềm để hỗ trợ đánh giá và báo cáo rủi ro.
* * *
### 2.3.2 Danh sách mở rộng
#### **CSRF Scanner**
*       *   Phát hiện các điểm dễ bị tấn công giả mạo yêu cầu liên trang (CSRF).
#### **HTTP Request Smuggler**
*       *   Kiểm thử và phát hiện lỗi HTTP request smuggling phức tạp.
#### **Logger++**
*       *   Ghi log chi tiết lưu lượng HTTP request/response, hỗ trợ tìm kiếm, lọc nâng cao.
#### **JWT4B (json-web-tokens)**
*       *   Tự động phát hiện, giải mã, và thao tác thủ công JWT trong Burp Proxy.
#### **Log4Shell Scanner**
*       *   Phát hiện lỗ hổng Log4Shell (CVE-2021-44228) tự động trong request/response.
#### **Param Miner**
*       *   Tự động phát hiện các tham số ẩn hoặc ít được biết trên website.
#### **Upload Scanner**
*       *   Kiểm thử bảo mật tính năng upload file, phát hiện bypass filter, chèn mã độc.
#### **Turbo Intruder**
*       *   Bruteforce, fuzz với tốc độ cực nhanh, thích hợp tấn công cần lặp nhiều request.
#### **Broken Link Hijacking**
*       *       *   Phát hiện các liên kết gãy dễ bị chiếm đoạt hoặc khai thác.
#### **Reflected Parameters**
*       *       *   Tìm các tham số HTTP có thể bị phản chiếu, hỗ trợ phát hiện XSS hoặc injection dựa phản chiếu.
